=================================================================================
Simple policy to detect DNS anomalies based on thresholds
=================================================================================

Following functionality are provided by the script
--------------------------------------------------

Installation
------------
	zkg install zeek/initconf/
	or
	@load 


Detailed Notes:
---------------

Detail Alerts and descriptions: Following alerts are generated by the script:
******************************************************************************

Heuristics  are simple: check for 

This should generate following Kinds of notices:

DNS::QueryThreshold
DNS::PTRThreshold



Example notice: 
***************************

Example Summary Notice: 
***************************

- DNS::QueryThreshold IP[6.169.199.211], numQueries: 99, uniqQueries: 100, Hosts: 1, Qtype:  [Unknown]: 1 [A]: 3 [PTR]: 95
- DNS::QueryThreshold IP[6.169.199.211], numQueries: 242, uniqQueries: 250, Hosts: 3, Qtype:  [Unknown]: 1 [A]: 7 [PTR]: 234
- DNS::QueryThreshold IP[6.169.199.211], numQueries: 503, uniqQueries: 500, Hosts: 3, Qtype:  [Unknown]: 2 [A]: 13 [PTR]: 488
- DNS::PTRThreshold IP[6.169.199.211] has done 500 look ups: [ptr_counts=500, noerror=174, nxdomain=239, refused=12, servfail=0, unknown=75]
- DNS::QueryThreshold IP[6.169.199.211], numQueries: 980, uniqQueries: 1000, Hosts: 3, Qtype:  [Unknown]: 3 [A]: 21 [PTR]: 956
- DNS::PTRThreshold IP[6.169.199.211] has done 1000 look ups: [ptr_counts=1000, noerror=360, nxdomain=486, refused=14, servfail=0, unknown=140]
- DNS::PTRThreshold IP[6.169.199.211] has done 5000 look ups: [ptr_counts=5000, noerror=1796, nxdomain=2433, refused=86, servfail=0, unknown=685]




